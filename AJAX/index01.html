<!DOCTYPE html>
<html lang="en">

<head>
    <title>AJAX DEMO 1</title>
</head>

<body>
    <h1> AJAX Demo 1 with JSON</h1> <button id="btn"> Load User Data</button>
    <h1> User Details</h1>
    <table border="1" id="table">
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>UserName</th>
            <th>Email</th>
            <th>Phone</th>
        </tr>
    </table>
    <script>
        var btnElmt = document.getElementById("btn");

        btnElmt.addEventListener("click", loadDataUsingAJAX);

        function loadDataUsingAJAX() {
            // 1. create the xmlHTTPRequest Object
            var xhttp = new XMLHttpRequest();

            //2. Open (method, url,async)
            xhttp.open("GET", "http://localhost:3000/users", true);


            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    var data = JSON.parse(this.responseText);
                    renderHTML(data)
                }
            };

            //3. send
            xhttp.send()

        }


        function renderHTML(data) {
            var parent = document.getElementById("table");
            for (let i = 0; i < data.length; i++) {
                var elmt = document.createElement("tr");

                var idElemt = document.createElement("td");
                idElemt.innerHTML = data[i].id;
                elmt.appendChild(idElemt);

                var nameElemt = document.createElement("td");
                nameElemt.innerHTML = data[i].name;
                elmt.appendChild(nameElemt);


                var usernameElemt = document.createElement("td");
                usernameElemt.innerHTML = data[i].username;
                elmt.appendChild(usernameElemt);

                var emailElemt = document.createElement("td");
                emailElemt.innerHTML = data[i].email;
                elmt.appendChild(emailElemt);


                var phoneElemt = document.createElement("td");
                phoneElemt.innerHTML = data[i].phone;
                elmt.appendChild(phoneElemt);


                parent.appendChild(elmt)
            }

        }
    </script>

</body>

</html>